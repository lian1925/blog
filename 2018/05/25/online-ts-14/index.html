
<!DOCTYPE html>

<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="icon" type="image/png" href="/img/sand2.png">
  <link rel="shortcut icon" type="image/x-icon" href="/img/sand2.png">
  <meta property="og:image" content="https://assets-cdn.github.com/images/modules/open_graph/github-octocat.png">
  
  <link rel="stylesheet" href="/css/style.css?v=1.3"> 
  <link href="//vjs.zencdn.net/6.7/video-js.min.css" rel="stylesheet">
  <script src="//vjs.zencdn.net/6.7/video.min.js"></script>
  
  <title>Modules | 小沙丘的网络漫游记</title>
 <meta name="description" content="" >

 <!-- 百度统计 -->
 <script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?eafa0040e1ab3bed28ce82ef03de6e01";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
  </script>
  
<link rel="stylesheet" href="/css/prism-ghcolors.css" type="text/css"></head>
<body>
  
  <script>
      if (/mobile/i.test(navigator.userAgent) || /android/i.test(navigator.userAgent)){
        document.body.classList.add('mobile');            
      } else{
        document.body.classList.add('pc');
        document.getElementsByTagName("html")[0].style.fontSize="62.5%";
      }
      var u = navigator.userAgent;
var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Adr') > -1; //android终端
var isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端
if(isiOS){
  document.body.classList.add('ios');
  document.getElementsByTagName("html")[0].style.fontSize="65%";
           
}
    </script>

  <div class="container">
<!-- 用于文章页面的顶部，提供返回主页和主题页的按键 -->
<!-- 头部开始 -->

<div id="header">
    <p>小沙丘的网络漫游记
      <span> » 
        <a href="/home/">首页</a>
      </span>
      
      <span> » 
          <a href="/tags/Typescript/">
            Typescript
          </a>
      </span>
      
    </p>
</div>

<!-- 头部结束 -->



<!-- 分类组件，放置于文章页面的顶部，提供上(或下)一篇导航按键。 -->
<div class="asset-nav">
    <div class="entry-categories">
      <p>主题：
        <span> 
            <a href="/tags/Typescript/">
              Typescript
            </a>
        </span>
      </p>
    </div>
    <div class="entry-location-mobile">
        <span>
            
            <a href="/2018/05/25/online-ts-13/">
            &#8676;
            </a>
        </span>
        <span>
            
            <a href="/2018/05/25/online-ts-15/">
              &#8677;
            </a>
        </span>
    </div>
    <div class="entry-location">
        <P>上一篇：
                <a href="/2018/05/25/online-ts-13/">
                    Iterators and Generators
                </a>
        </P>
        <P>下一篇：

                <a href="/2018/05/25/online-ts-15/">
                    Namespaces
                </a>
        </P>
    </div>
</div>

<div class="post">
<div class="title-post">
<h1>Modules</h1>
<div class="post-meta">
  <p>作者： Lian</p>
  <p>日期：
    2018年05月25日 18:05
  </p>
</div>
</div>



  
  <div class="page">
      <blockquote>
<p><strong>A note about terminology:</strong><br>It’s important to note that in TypeScript 1.5, the nomenclature has changed.<br>“Internal modules” are now “namespaces”.<br>“External modules” are now simply “modules”, as to align with <a href="http://www.ecma-international.org/ecma-262/6.0/" target="_blank" rel="external">ECMAScript 2015</a>‘s terminology, (namely that <code>module X {</code> is equivalent to the now-preferred <code>namespace X {</code>).</p>
</blockquote>
<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Starting with ECMAScript 2015, JavaScript has a concept of modules. TypeScript shares this concept.</p>
<p>Modules are executed within their own scope, not in the global scope; this means that variables, functions, classes, etc. declared in a module are not visible outside the module unless they are explicitly exported using one of the <a href="#export"><code>export</code> forms</a>.<br>Conversely, to consume a variable, function, class, interface, etc. exported from a different module, it has to be imported using one of the <a href="#import"><code>import</code> forms</a>.</p>
<p>Modules are declarative; the relationships between modules are specified in terms of imports and exports at the file level.</p>
<p>Modules import one another using a module loader.<br>At runtime the module loader is responsible for locating and executing all dependencies of a module before executing it.<br>Well-known modules loaders used in JavaScript are the <a href="https://en.wikipedia.org/wiki/CommonJS" target="_blank" rel="external">CommonJS</a> module loader for Node.js and <a href="http://requirejs.org/" target="_blank" rel="external">require.js</a> for Web applications.</p>
<p>In TypeScript, just as in ECMAScript 2015, any file containing a top-level <code>import</code> or <code>export</code> is considered a module.</p>
<h1 id="Export"><a href="#Export" class="headerlink" title="Export"></a>Export</h1><h2 id="Exporting-a-declaration"><a href="#Exporting-a-declaration" class="headerlink" title="Exporting a declaration"></a>Exporting a declaration</h2><p>Any declaration (such as a variable, function, class, type alias, or interface) can be exported by adding the <code>export</code> keyword.</p>
<h5 id="Validation-ts"><a href="#Validation-ts" class="headerlink" title="Validation.ts"></a>Validation.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">StringValidator</span> <span class="token punctuation">{</span>
    <span class="token function">isAcceptable</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h5 id="ZipCodeValidator-ts"><a href="#ZipCodeValidator-ts" class="headerlink" title="ZipCodeValidator.ts"></a>ZipCodeValidator.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">const</span> numberRegexp <span class="token operator">=</span> <span class="token regex">/^[0-9]+$/</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ZipCodeValidator</span> <span class="token keyword">implements</span> <span class="token class-name">StringValidator</span> <span class="token punctuation">{</span>
    <span class="token function">isAcceptable</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> s<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">5</span> <span class="token operator">&amp;&amp;</span> numberRegexp<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="Export-statements"><a href="#Export-statements" class="headerlink" title="Export statements"></a>Export statements</h2><p>Export statements are handy when exports need to be renamed for consumers, so the above example can be written as:</p>
<pre class=" language-ts"><code class="language-ts"><span class="token keyword">class</span> <span class="token class-name">ZipCodeValidator</span> <span class="token keyword">implements</span> <span class="token class-name">StringValidator</span> <span class="token punctuation">{</span>
    <span class="token function">isAcceptable</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> s<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">5</span> <span class="token operator">&amp;&amp;</span> numberRegexp<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> ZipCodeValidator <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> ZipCodeValidator as mainValidator <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="Re-exports"><a href="#Re-exports" class="headerlink" title="Re-exports"></a>Re-exports</h2><p>Often modules extend other modules, and partially expose some of their features.<br>A re-export does not import it locally, or introduce a local variable.</p>
<h5 id="ParseIntBasedZipCodeValidator-ts"><a href="#ParseIntBasedZipCodeValidator-ts" class="headerlink" title="ParseIntBasedZipCodeValidator.ts"></a>ParseIntBasedZipCodeValidator.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ParseIntBasedZipCodeValidator</span> <span class="token punctuation">{</span>
    <span class="token function">isAcceptable</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> s<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">5</span> <span class="token operator">&amp;&amp;</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> s<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">// Export original validator but rename it</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>ZipCodeValidator as RegExpBasedZipCodeValidator<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./ZipCodeValidator"</span><span class="token punctuation">;</span>
</code></pre>
<p>Optionally, a module can wrap one or more modules and combine all their exports using <code>export * from &quot;module&quot;</code> syntax.</p>
<h5 id="AllValidators-ts"><a href="#AllValidators-ts" class="headerlink" title="AllValidators.ts"></a>AllValidators.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">"./StringValidator"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// exports interface 'StringValidator'</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">"./LettersOnlyValidator"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// exports class 'LettersOnlyValidator'</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">"./ZipCodeValidator"</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// exports class 'ZipCodeValidator'</span>
</code></pre>
<h1 id="Import"><a href="#Import" class="headerlink" title="Import"></a>Import</h1><p>Importing is just about as easy as exporting from a module.<br>Importing an exported declaration is done through using one of the <code>import</code> forms below:</p>
<h2 id="Import-a-single-export-from-a-module"><a href="#Import-a-single-export-from-a-module" class="headerlink" title="Import a single export from a module"></a>Import a single export from a module</h2><pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> ZipCodeValidator <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./ZipCodeValidator"</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> myValidator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ZipCodeValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>imports can also be renamed</p>
<pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> ZipCodeValidator as ZCV <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./ZipCodeValidator"</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> myValidator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ZCV</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="Import-the-entire-module-into-a-single-variable-and-use-it-to-access-the-module-exports"><a href="#Import-the-entire-module-into-a-single-variable-and-use-it-to-access-the-module-exports" class="headerlink" title="Import the entire module into a single variable, and use it to access the module exports"></a>Import the entire module into a single variable, and use it to access the module exports</h2><pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> as validator <span class="token keyword">from</span> <span class="token string">"./ZipCodeValidator"</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> myValidator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">validator<span class="token punctuation">.</span>ZipCodeValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="Import-a-module-for-side-effects-only"><a href="#Import-a-module-for-side-effects-only" class="headerlink" title="Import a module for side-effects only"></a>Import a module for side-effects only</h2><p>Though not recommended practice, some modules set up some global state that can be used by other modules.<br>These modules may not have any exports, or the consumer is not interested in any of their exports.<br>To import these modules, use:</p>
<pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token string">"./my-module.js"</span><span class="token punctuation">;</span>
</code></pre>
<h1 id="Default-exports"><a href="#Default-exports" class="headerlink" title="Default exports"></a>Default exports</h1><p>Each module can optionally export a <code>default</code> export.<br>Default exports are marked with the keyword <code>default</code>; and there can only be one <code>default</code> export per module.<br><code>default</code> exports are imported using a different import form.</p>
<p><code>default</code> exports are really handy.<br>For instance, a library like JQuery might have a default export of <code>jQuery</code> or <code>$</code>, which we’d probably also import under the name <code>$</code> or <code>jQuery</code>.</p>
<h5 id="JQuery-d-ts"><a href="#JQuery-d-ts" class="headerlink" title="JQuery.d.ts"></a>JQuery.d.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">declare</span> <span class="token keyword">let</span> $<span class="token punctuation">:</span> JQuery<span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> $<span class="token punctuation">;</span>
</code></pre>
<h5 id="App-ts"><a href="#App-ts" class="headerlink" title="App.ts"></a>App.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> $ <span class="token keyword">from</span> <span class="token string">"JQuery"</span><span class="token punctuation">;</span>

<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"button.continue"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span> <span class="token string">"Next Step..."</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Classes and function declarations can be authored directly as default exports.<br>Default export class and function declaration names are optional.</p>
<h5 id="ZipCodeValidator-ts-1"><a href="#ZipCodeValidator-ts-1" class="headerlink" title="ZipCodeValidator.ts"></a>ZipCodeValidator.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">ZipCodeValidator</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> numberRegexp <span class="token operator">=</span> <span class="token regex">/^[0-9]+$/</span><span class="token punctuation">;</span>
    <span class="token function">isAcceptable</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> s<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">5</span> <span class="token operator">&amp;&amp;</span> ZipCodeValidator<span class="token punctuation">.</span>numberRegexp<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h5 id="Test-ts"><a href="#Test-ts" class="headerlink" title="Test.ts"></a>Test.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> validator <span class="token keyword">from</span> <span class="token string">"./ZipCodeValidator"</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> myValidator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">validator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>or</p>
<h5 id="StaticZipCodeValidator-ts"><a href="#StaticZipCodeValidator-ts" class="headerlink" title="StaticZipCodeValidator.ts"></a>StaticZipCodeValidator.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">const</span> numberRegexp <span class="token operator">=</span> <span class="token regex">/^[0-9]+$/</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> s<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">5</span> <span class="token operator">&amp;&amp;</span> numberRegexp<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h5 id="Test-ts-1"><a href="#Test-ts-1" class="headerlink" title="Test.ts"></a>Test.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> validate <span class="token keyword">from</span> <span class="token string">"./StaticZipCodeValidator"</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> strings <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Hello"</span><span class="token punctuation">,</span> <span class="token string">"98052"</span><span class="token punctuation">,</span> <span class="token string">"101"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// Use function validate</span>
strings<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>s <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>s<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">" </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">validate</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">" matches"</span> <span class="token punctuation">:</span> <span class="token string">" does not match"</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p><code>default</code> exports can also be just values:</p>
<h5 id="OneTwoThree-ts"><a href="#OneTwoThree-ts" class="headerlink" title="OneTwoThree.ts"></a>OneTwoThree.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token string">"123"</span><span class="token punctuation">;</span>
</code></pre>
<h5 id="Log-ts"><a href="#Log-ts" class="headerlink" title="Log.ts"></a>Log.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> num <span class="token keyword">from</span> <span class="token string">"./OneTwoThree"</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// "123"</span>
</code></pre>
<h1 id="export-and-import-require"><a href="#export-and-import-require" class="headerlink" title="export = and import = require()"></a><code>export =</code> and <code>import = require()</code></h1><p>Both CommonJS and AMD generally have the concept of an <code>exports</code> object which contains all exports from a module.</p>
<p>They also support replacing the <code>exports</code> object with a custom single object.<br>Default exports are meant to act as a replacement for this behavior; however, the two are incompatible.<br>TypeScript supports <code>export =</code> to model the traditional CommonJS and AMD workflow.</p>
<p>The <code>export =</code> syntax specifies a single object that is exported from the module.<br>This can be a class, interface, namespace, function, or enum.</p>
<p>When importing a module using <code>export =</code>, TypeScript-specific <code>import module = require(&quot;module&quot;)</code> must be used to import the module.</p>
<h5 id="ZipCodeValidator-ts-2"><a href="#ZipCodeValidator-ts-2" class="headerlink" title="ZipCodeValidator.ts"></a>ZipCodeValidator.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">let</span> numberRegexp <span class="token operator">=</span> <span class="token regex">/^[0-9]+$/</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">ZipCodeValidator</span> <span class="token punctuation">{</span>
    <span class="token function">isAcceptable</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> s<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">5</span> <span class="token operator">&amp;&amp;</span> numberRegexp<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token operator">=</span> ZipCodeValidator<span class="token punctuation">;</span>
</code></pre>
<h5 id="Test-ts-2"><a href="#Test-ts-2" class="headerlink" title="Test.ts"></a>Test.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> zip <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./ZipCodeValidator"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// Some samples to try</span>
<span class="token keyword">let</span> strings <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Hello"</span><span class="token punctuation">,</span> <span class="token string">"98052"</span><span class="token punctuation">,</span> <span class="token string">"101"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// Validators to use</span>
<span class="token keyword">let</span> validator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">zip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// Show whether each string passed each validator</span>
strings<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>s <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> s <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">" - </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> validator<span class="token punctuation">.</span><span class="token function">isAcceptable</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">"matches"</span> <span class="token punctuation">:</span> <span class="token string">"does not match"</span> <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h1 id="Code-Generation-for-Modules"><a href="#Code-Generation-for-Modules" class="headerlink" title="Code Generation for Modules"></a>Code Generation for Modules</h1><p>Depending on the module target specified during compilation, the compiler will generate appropriate code for Node.js (<a href="http://wiki.commonjs.org/wiki/CommonJS" target="_blank" rel="external">CommonJS</a>), require.js (<a href="https://github.com/amdjs/amdjs-api/wiki/AMD" target="_blank" rel="external">AMD</a>), isomorphic (<a href="https://github.com/umdjs/umd" target="_blank" rel="external">UMD</a>), <a href="https://github.com/systemjs/systemjs" target="_blank" rel="external">SystemJS</a>, or <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-modules" target="_blank" rel="external">ECMAScript 2015 native modules</a> (ES6) module-loading systems.<br>For more information on what the <code>define</code>, <code>require</code> and <code>register</code> calls in the generated code do, consult the documentation for each module loader.</p>
<p>This simple example shows how the names used during importing and exporting get translated into the module loading code.</p>
<h5 id="SimpleModule-ts"><a href="#SimpleModule-ts" class="headerlink" title="SimpleModule.ts"></a>SimpleModule.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> m <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"mod"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">let</span> t <span class="token operator">=</span> m<span class="token punctuation">.</span>something <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre>
<h5 id="AMD-RequireJS-SimpleModule-js"><a href="#AMD-RequireJS-SimpleModule-js" class="headerlink" title="AMD / RequireJS SimpleModule.js"></a>AMD / RequireJS SimpleModule.js</h5><pre class=" language-js"><code class="language-js"><span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"require"</span><span class="token punctuation">,</span> <span class="token string">"exports"</span><span class="token punctuation">,</span> <span class="token string">"./mod"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>require<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> mod_1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    exports<span class="token punctuation">.</span>t <span class="token operator">=</span> mod_1<span class="token punctuation">.</span>something <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h5 id="CommonJS-Node-SimpleModule-js"><a href="#CommonJS-Node-SimpleModule-js" class="headerlink" title="CommonJS / Node SimpleModule.js"></a>CommonJS / Node SimpleModule.js</h5><pre class=" language-js"><code class="language-js"><span class="token keyword">var</span> mod_1 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./mod"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>t <span class="token operator">=</span> mod_1<span class="token punctuation">.</span>something <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre>
<h5 id="UMD-SimpleModule-js"><a href="#UMD-SimpleModule-js" class="headerlink" title="UMD SimpleModule.js"></a>UMD SimpleModule.js</h5><pre class=" language-js"><code class="language-js"><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>factory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> module <span class="token operator">===</span> <span class="token string">"object"</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> module<span class="token punctuation">.</span>exports <span class="token operator">===</span> <span class="token string">"object"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> v <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span>require<span class="token punctuation">,</span> exports<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>v <span class="token operator">!==</span> undefined<span class="token punctuation">)</span> module<span class="token punctuation">.</span>exports <span class="token operator">=</span> v<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> define <span class="token operator">===</span> <span class="token string">"function"</span> <span class="token operator">&amp;&amp;</span> define<span class="token punctuation">.</span>amd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"require"</span><span class="token punctuation">,</span> <span class="token string">"exports"</span><span class="token punctuation">,</span> <span class="token string">"./mod"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> factory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>require<span class="token punctuation">,</span> exports<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> mod_1 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./mod"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    exports<span class="token punctuation">.</span>t <span class="token operator">=</span> mod_1<span class="token punctuation">.</span>something <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h5 id="System-SimpleModule-js"><a href="#System-SimpleModule-js" class="headerlink" title="System SimpleModule.js"></a>System SimpleModule.js</h5><pre class=" language-js"><code class="language-js">System<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"./mod"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>exports_1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> mod_1<span class="token punctuation">;</span>
    <span class="token keyword">var</span> t<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        setters<span class="token punctuation">:</span><span class="token punctuation">[</span>
            <span class="token keyword">function</span> <span class="token punctuation">(</span>mod_1_1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                mod_1 <span class="token operator">=</span> mod_1_1<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        execute<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">exports_1</span><span class="token punctuation">(</span><span class="token string">"t"</span><span class="token punctuation">,</span> t <span class="token operator">=</span> mod_1<span class="token punctuation">.</span>something <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h5 id="Native-ECMAScript-2015-modules-SimpleModule-js"><a href="#Native-ECMAScript-2015-modules-SimpleModule-js" class="headerlink" title="Native ECMAScript 2015 modules SimpleModule.js"></a>Native ECMAScript 2015 modules SimpleModule.js</h5><pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> something <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./mod"</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">var</span> t <span class="token operator">=</span> something <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre>
<h1 id="Simple-Example"><a href="#Simple-Example" class="headerlink" title="Simple Example"></a>Simple Example</h1><p>Below, we’ve consolidated the Validator implementations used in previous examples to only export a single named export from each module.</p>
<p>To compile, we must specify a module target on the command line. For Node.js, use <code>--module commonjs</code>;<br>for require.js, use <code>--module amd</code>. For example:</p>
<pre class=" language-Shell"><code class="language-Shell">tsc --module commonjs Test.ts
</code></pre>
<p>When compiled, each module will become a separate <code>.js</code> file.<br>As with reference tags, the compiler will follow <code>import</code> statements to compile dependent files.</p>
<h5 id="Validation-ts-1"><a href="#Validation-ts-1" class="headerlink" title="Validation.ts"></a>Validation.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">StringValidator</span> <span class="token punctuation">{</span>
    <span class="token function">isAcceptable</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h5 id="LettersOnlyValidator-ts"><a href="#LettersOnlyValidator-ts" class="headerlink" title="LettersOnlyValidator.ts"></a>LettersOnlyValidator.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> StringValidator <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./Validation"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> lettersRegexp <span class="token operator">=</span> <span class="token regex">/^[A-Za-z]+$/</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">LettersOnlyValidator</span> <span class="token keyword">implements</span> <span class="token class-name">StringValidator</span> <span class="token punctuation">{</span>
    <span class="token function">isAcceptable</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> lettersRegexp<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h5 id="ZipCodeValidator-ts-3"><a href="#ZipCodeValidator-ts-3" class="headerlink" title="ZipCodeValidator.ts"></a>ZipCodeValidator.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> StringValidator <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./Validation"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> numberRegexp <span class="token operator">=</span> <span class="token regex">/^[0-9]+$/</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ZipCodeValidator</span> <span class="token keyword">implements</span> <span class="token class-name">StringValidator</span> <span class="token punctuation">{</span>
    <span class="token function">isAcceptable</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> s<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">5</span> <span class="token operator">&amp;&amp;</span> numberRegexp<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h5 id="Test-ts-3"><a href="#Test-ts-3" class="headerlink" title="Test.ts"></a>Test.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> StringValidator <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./Validation"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ZipCodeValidator <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./ZipCodeValidator"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> LettersOnlyValidator <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./LettersOnlyValidator"</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// Some samples to try</span>
<span class="token keyword">let</span> strings <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Hello"</span><span class="token punctuation">,</span> <span class="token string">"98052"</span><span class="token punctuation">,</span> <span class="token string">"101"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// Validators to use</span>
<span class="token keyword">let</span> validators<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>s<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">]</span><span class="token punctuation">:</span> StringValidator<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
validators<span class="token punctuation">[</span><span class="token string">"ZIP code"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ZipCodeValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
validators<span class="token punctuation">[</span><span class="token string">"Letters only"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LettersOnlyValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// Show whether each string passed each validator</span>
strings<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>s <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> name <span class="token keyword">in</span> validators<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> s <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">" - </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> validators<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">isAcceptable</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">"matches"</span> <span class="token punctuation">:</span> <span class="token string">"does not match"</span> <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> name <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h1 id="Optional-Module-Loading-and-Other-Advanced-Loading-Scenarios"><a href="#Optional-Module-Loading-and-Other-Advanced-Loading-Scenarios" class="headerlink" title="Optional Module Loading and Other Advanced Loading Scenarios"></a>Optional Module Loading and Other Advanced Loading Scenarios</h1><p>In some cases, you may want to only load a module under some conditions.<br>In TypeScript, we can use the pattern shown below to implement this and other advanced loading scenarios to directly invoke the module loaders without losing type safety.</p>
<p>The compiler detects whether each module is used in the emitted JavaScript.<br>If a module identifier is only ever used as part of a type annotations and never as an expression, then no <code>require</code> call is emitted for that module.<br>This elision of unused references is a good performance optimization, and also allows for optional loading of those modules.</p>
<p>The core idea of the pattern is that the <code>import id = require(&quot;...&quot;)</code> statement gives us access to the types exposed by the module.<br>The module loader is invoked (through <code>require</code>) dynamically, as shown in the <code>if</code> blocks below.<br>This leverages the reference-elision optimization so that the module is only loaded when needed.<br>For this pattern to work, it’s important that the symbol defined via an <code>import</code> is only used in type positions (i.e. never in a position that would be emitted into the JavaScript).</p>
<p>To maintain type safety, we can use the <code>typeof</code> keyword.<br>The <code>typeof</code> keyword, when used in a type position, produces the type of a value, in this case the type of the module.</p>
<h5 id="Dynamic-Module-Loading-in-Node-js"><a href="#Dynamic-Module-Loading-in-Node-js" class="headerlink" title="Dynamic Module Loading in Node.js"></a>Dynamic Module Loading in Node.js</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">require</span><span class="token punctuation">(</span>moduleName<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> ZipCodeValidator as Zip <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./ZipCodeValidator"</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>needZipValidation<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> ZipCodeValidator<span class="token punctuation">:</span> <span class="token keyword">typeof</span> Zip <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./ZipCodeValidator"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> validator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ZipCodeValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>validator<span class="token punctuation">.</span><span class="token function">isAcceptable</span><span class="token punctuation">(</span><span class="token string">"..."</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* ... */</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h5 id="Sample-Dynamic-Module-Loading-in-require-js"><a href="#Sample-Dynamic-Module-Loading-in-require-js" class="headerlink" title="Sample: Dynamic Module Loading in require.js"></a>Sample: Dynamic Module Loading in require.js</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">require</span><span class="token punctuation">(</span>moduleNames<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> onLoad<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>

<span class="token keyword">import</span>  <span class="token operator">*</span> as Zip <span class="token keyword">from</span> <span class="token string">"./ZipCodeValidator"</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>needZipValidation<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"./ZipCodeValidator"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ZipCodeValidator<span class="token punctuation">:</span> <span class="token keyword">typeof</span> Zip<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> validator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ZipCodeValidator<span class="token punctuation">.</span>ZipCodeValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>validator<span class="token punctuation">.</span><span class="token function">isAcceptable</span><span class="token punctuation">(</span><span class="token string">"..."</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* ... */</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h5 id="Sample-Dynamic-Module-Loading-in-System-js"><a href="#Sample-Dynamic-Module-Loading-in-System-js" class="headerlink" title="Sample: Dynamic Module Loading in System.js"></a>Sample: Dynamic Module Loading in System.js</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">declare</span> <span class="token keyword">const</span> System<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> ZipCodeValidator as Zip <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./ZipCodeValidator"</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>needZipValidation<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    System<span class="token punctuation">.</span><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">"./ZipCodeValidator"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ZipCodeValidator<span class="token punctuation">:</span> <span class="token keyword">typeof</span> Zip<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ZipCodeValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">isAcceptable</span><span class="token punctuation">(</span><span class="token string">"..."</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* ... */</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h1 id="Working-with-Other-JavaScript-Libraries"><a href="#Working-with-Other-JavaScript-Libraries" class="headerlink" title="Working with Other JavaScript Libraries"></a>Working with Other JavaScript Libraries</h1><p>To describe the shape of libraries not written in TypeScript, we need to declare the API that the library exposes.</p>
<p>We call declarations that don’t define an implementation “ambient”.<br>Typically, these are defined in <code>.d.ts</code> files.<br>If you’re familiar with C/C++, you can think of these as <code>.h</code> files.<br>Let’s look at a few examples.</p>
<h2 id="Ambient-Modules"><a href="#Ambient-Modules" class="headerlink" title="Ambient Modules"></a>Ambient Modules</h2><p>In Node.js, most tasks are accomplished by loading one or more modules.<br>We could define each module in its own <code>.d.ts</code> file with top-level export declarations, but it’s more convenient to write them as one larger <code>.d.ts</code> file.<br>To do so, we use a construct similar to ambient namespaces, but we use the <code>module</code> keyword and the quoted name of the module which will be available to a later import.<br>For example:</p>
<h5 id="node-d-ts-simplified-excerpt"><a href="#node-d-ts-simplified-excerpt" class="headerlink" title="node.d.ts (simplified excerpt)"></a>node.d.ts (simplified excerpt)</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">"url"</span> <span class="token punctuation">{</span>
    <span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Url</span> <span class="token punctuation">{</span>
        protocol<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>
        hostname<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>
        pathname<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">parse</span><span class="token punctuation">(</span>urlStr<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">,</span> parseQueryString<span class="token operator">?</span><span class="token punctuation">,</span> slashesDenoteHost<span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Url<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">"path"</span> <span class="token punctuation">{</span>
    <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">normalize</span><span class="token punctuation">(</span>p<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>
    <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">join</span><span class="token punctuation">(</span><span class="token operator">...</span>paths<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>
    <span class="token keyword">export</span> <span class="token keyword">var</span> sep<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Now we can <code>/// &lt;reference&gt;</code> <code>node.d.ts</code> and then load the modules using <code>import url = require(&quot;url&quot;);</code> or <code>import * as URL from &quot;url&quot;</code>.</p>
<pre class=" language-ts"><code class="language-ts"><span class="token comment" spellcheck="true">/// &lt;reference path="node.d.ts"/></span>
<span class="token keyword">import</span> <span class="token operator">*</span> as URL <span class="token keyword">from</span> <span class="token string">"url"</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> myUrl <span class="token operator">=</span> URL<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">"http://www.typescriptlang.org"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="Shorthand-ambient-modules"><a href="#Shorthand-ambient-modules" class="headerlink" title="Shorthand ambient modules"></a>Shorthand ambient modules</h3><p>If you don’t want to take the time to write out declarations before using a new module, you can use a shorthand declaration to get started quickly.</p>
<h5 id="declarations-d-ts"><a href="#declarations-d-ts" class="headerlink" title="declarations.d.ts"></a>declarations.d.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">"hot-new-module"</span><span class="token punctuation">;</span>
</code></pre>
<p>All imports from a shorthand module will have the <code>any</code> type.</p>
<pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> x<span class="token punctuation">,</span> <span class="token punctuation">{</span>y<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"hot-new-module"</span><span class="token punctuation">;</span>
<span class="token function">x</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="Wildcard-module-declarations"><a href="#Wildcard-module-declarations" class="headerlink" title="Wildcard module declarations"></a>Wildcard module declarations</h3><p>Some module loaders such as <a href="https://github.com/systemjs/systemjs/blob/master/docs/overview.md#plugin-syntax" target="_blank" rel="external">SystemJS</a><br>and <a href="https://github.com/amdjs/amdjs-api/blob/master/LoaderPlugins.md" target="_blank" rel="external">AMD</a> allow non-JavaScript content to be imported.<br>These typically use a prefix or suffix to indicate the special loading semantics.<br>Wildcard module declarations can be used to cover these cases.</p>
<pre class=" language-ts"><code class="language-ts"><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">"*!text"</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> content<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>
    <span class="token keyword">export</span> <span class="token keyword">default</span> content<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">// Some do it the other way around.</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">"json!*"</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> value<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">;</span>
    <span class="token keyword">export</span> <span class="token keyword">default</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Now you can import things that match <code>&quot;*!text&quot;</code> or <code>&quot;json!*&quot;</code>.</p>
<pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> fileContent <span class="token keyword">from</span> <span class="token string">"./xyz.txt!text"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> data <span class="token keyword">from</span> <span class="token string">"json!http://example.com/data.json"</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> fileContent<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="UMD-modules"><a href="#UMD-modules" class="headerlink" title="UMD modules"></a>UMD modules</h3><p>Some libraries are designed to be used in many module loaders, or with no module loading (global variables).<br>These are known as <a href="https://github.com/umdjs/umd" target="_blank" rel="external">UMD</a> or <a href="http://isomorphic.net" target="_blank" rel="external">Isomorphic</a> modules.<br>These libraries can be accessed through either an import or a global variable.<br>For example:</p>
<h5 id="math-lib-d-ts"><a href="#math-lib-d-ts" class="headerlink" title="math-lib.d.ts"></a>math-lib.d.ts</h5><pre class=" language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">isPrime</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token keyword">number</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">boolean</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> as namespace mathLib<span class="token punctuation">;</span>
</code></pre>
<p>The library can then be used as an import within modules:</p>
<pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> isPrime <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"math-lib"</span><span class="token punctuation">;</span>
<span class="token function">isPrime</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mathLib<span class="token punctuation">.</span><span class="token function">isPrime</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ERROR: can't use the global definition from inside a module</span>
</code></pre>
<p>It can also be used as a global variable, but only inside of a script.<br>(A script is a file with no imports or exports.)</p>
<pre class=" language-ts"><code class="language-ts">mathLib<span class="token punctuation">.</span><span class="token function">isPrime</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h1 id="Guidance-for-structuring-modules"><a href="#Guidance-for-structuring-modules" class="headerlink" title="Guidance for structuring modules"></a>Guidance for structuring modules</h1><h2 id="Export-as-close-to-top-level-as-possible"><a href="#Export-as-close-to-top-level-as-possible" class="headerlink" title="Export as close to top-level as possible"></a>Export as close to top-level as possible</h2><p>Consumers of your module should have as little friction as possible when using things that you export.<br>Adding too many levels of nesting tends to be cumbersome, so think carefully about how you want to structure things.</p>
<p>Exporting a namespace from your module is an example of adding too many layers of nesting.<br>While namespaces sometime have their uses, they add an extra level of indirection when using modules.<br>This can quickly become a pain point for users, and is usually unnecessary.</p>
<p>Static methods on an exported class have a similar problem - the class itself adds a layer of nesting.<br>Unless it increases expressivity or intent in a clearly useful way, consider simply exporting a helper function.</p>
<h3 id="If-you’re-only-exporting-a-single-class-or-function-use-export-default"><a href="#If-you’re-only-exporting-a-single-class-or-function-use-export-default" class="headerlink" title="If you’re only exporting a single class or function, use export default"></a>If you’re only exporting a single <code>class</code> or <code>function</code>, use <code>export default</code></h3><p>Just as “exporting near the top-level” reduces friction on your module’s consumers, so does introducing a default export.<br>If a module’s primary purpose is to house one specific export, then you should consider exporting it as a default export.<br>This makes both importing and actually using the import a little easier.<br>For example:</p>
<h4 id="MyClass-ts"><a href="#MyClass-ts" class="headerlink" title="MyClass.ts"></a>MyClass.ts</h4><pre class=" language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">SomeType</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4 id="MyFunc-ts"><a href="#MyFunc-ts" class="headerlink" title="MyFunc.ts"></a>MyFunc.ts</h4><pre class=" language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">getThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">"thing"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre>
<h4 id="Consumer-ts"><a href="#Consumer-ts" class="headerlink" title="Consumer.ts"></a>Consumer.ts</h4><pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> t <span class="token keyword">from</span> <span class="token string">"./MyClass"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> f <span class="token keyword">from</span> <span class="token string">"./MyFunc"</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">t</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>This is optimal for consumers. They can name your type whatever they want (<code>t</code> in this case) and don’t have to do any excessive dotting to find your objects.</p>
<h3 id="If-you’re-exporting-multiple-objects-put-them-all-at-top-level"><a href="#If-you’re-exporting-multiple-objects-put-them-all-at-top-level" class="headerlink" title="If you’re exporting multiple objects, put them all at top-level"></a>If you’re exporting multiple objects, put them all at top-level</h3><h4 id="MyThings-ts"><a href="#MyThings-ts" class="headerlink" title="MyThings.ts"></a>MyThings.ts</h4><pre class=" language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">SomeType</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* ... */</span> <span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">someFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* ... */</span> <span class="token punctuation">}</span>
</code></pre>
<p>Conversely when importing:</p>
<h3 id="Explicitly-list-imported-names"><a href="#Explicitly-list-imported-names" class="headerlink" title="Explicitly list imported names"></a>Explicitly list imported names</h3><h4 id="Consumer-ts-1"><a href="#Consumer-ts-1" class="headerlink" title="Consumer.ts"></a>Consumer.ts</h4><pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> SomeType<span class="token punctuation">,</span> someFunc <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./MyThings"</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SomeType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token function">someFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="Use-the-namespace-import-pattern-if-you’re-importing-a-large-number-of-things"><a href="#Use-the-namespace-import-pattern-if-you’re-importing-a-large-number-of-things" class="headerlink" title="Use the namespace import pattern if you’re importing a large number of things"></a>Use the namespace import pattern if you’re importing a large number of things</h3><h4 id="MyLargeModule-ts"><a href="#MyLargeModule-ts" class="headerlink" title="MyLargeModule.ts"></a>MyLargeModule.ts</h4><pre class=" language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Dog</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Cat</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Tree</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Flower</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
</code></pre>
<h4 id="Consumer-ts-2"><a href="#Consumer-ts-2" class="headerlink" title="Consumer.ts"></a>Consumer.ts</h4><pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> as myLargeModule <span class="token keyword">from</span> <span class="token string">"./MyLargeModule.ts"</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">myLargeModule<span class="token punctuation">.</span>Dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="Re-export-to-extend"><a href="#Re-export-to-extend" class="headerlink" title="Re-export to extend"></a>Re-export to extend</h2><p>Often you will need to extend functionality on a module.<br>A common JS pattern is to augment the original object with <em>extensions</em>, similar to how JQuery extensions work.<br>As we’ve mentioned before, modules do not <em>merge</em> like global namespace objects would.<br>The recommended solution is to <em>not</em> mutate the original object, but rather export a new entity that provides the new functionality.</p>
<p>Consider a simple calculator implementation defined in module <code>Calculator.ts</code>.<br>The module also exports a helper function to test the calculator functionality by passing a list of input strings and writing the result at the end.</p>
<h4 id="Calculator-ts"><a href="#Calculator-ts" class="headerlink" title="Calculator.ts"></a>Calculator.ts</h4><pre class=" language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Calculator</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> current <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> memory <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> operator<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>

    <span class="token keyword">protected</span> <span class="token function">processDigit</span><span class="token punctuation">(</span>digit<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">,</span> currentValue<span class="token punctuation">:</span> <span class="token keyword">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>digit <span class="token operator">>=</span> <span class="token string">"0"</span> <span class="token operator">&amp;&amp;</span> digit <span class="token operator">&lt;=</span> <span class="token string">"9"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> currentValue <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token punctuation">(</span>digit<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token string">"0"</span><span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token function">processOperator</span><span class="token punctuation">(</span>operator<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"+"</span><span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token punctuation">,</span> <span class="token string">"*"</span><span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>operator<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> operator<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token function">evaluateOperator</span><span class="token punctuation">(</span>operator<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">,</span> left<span class="token punctuation">:</span> <span class="token keyword">number</span><span class="token punctuation">,</span> right<span class="token punctuation">:</span> <span class="token keyword">number</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">number</span> <span class="token punctuation">{</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>operator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> <span class="token string">"+"</span><span class="token punctuation">:</span> <span class="token keyword">return</span> left <span class="token operator">+</span> right<span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">"-"</span><span class="token punctuation">:</span> <span class="token keyword">return</span> left <span class="token operator">-</span> right<span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">"*"</span><span class="token punctuation">:</span> <span class="token keyword">return</span> left <span class="token operator">*</span> right<span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">"/"</span><span class="token punctuation">:</span> <span class="token keyword">return</span> left <span class="token operator">/</span> right<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>operator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>memory <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">evaluateOperator</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>operator<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>memory<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>memory <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>current<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">handelChar</span><span class="token punctuation">(</span>char<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>char <span class="token operator">===</span> <span class="token string">"="</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">processDigit</span><span class="token punctuation">(</span>char<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">!==</span> undefined<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>current <span class="token operator">=</span> value<span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">processOperator</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">!==</span> undefined<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>operator <span class="token operator">=</span> value<span class="token punctuation">;</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Unsupported input: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>char<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>memory<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span>c<span class="token punctuation">:</span> Calculator<span class="token punctuation">,</span> input<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> input<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        c<span class="token punctuation">.</span><span class="token function">handelChar</span><span class="token punctuation">(</span>input<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`result of '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>input<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">' is '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>c<span class="token punctuation">.</span><span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Here is a simple test for the calculator using the exposed <code>test</code> function.</p>
<h4 id="TestCalculator-ts"><a href="#TestCalculator-ts" class="headerlink" title="TestCalculator.ts"></a>TestCalculator.ts</h4><pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> Calculator<span class="token punctuation">,</span> test <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./Calculator"</span><span class="token punctuation">;</span>


<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Calculator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">test</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token string">"1+2*33/11="</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// prints 9</span>
</code></pre>
<p>Now to extend this to add support for input with numbers in bases other than 10, let’s create <code>ProgrammerCalculator.ts</code></p>
<h4 id="ProgrammerCalculator-ts"><a href="#ProgrammerCalculator-ts" class="headerlink" title="ProgrammerCalculator.ts"></a>ProgrammerCalculator.ts</h4><pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> Calculator <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./Calculator"</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ProgrammerCalculator</span> <span class="token keyword">extends</span> <span class="token class-name">Calculator</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> digits <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"0"</span><span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">,</span> <span class="token string">"3"</span><span class="token punctuation">,</span> <span class="token string">"4"</span><span class="token punctuation">,</span> <span class="token string">"5"</span><span class="token punctuation">,</span> <span class="token string">"6"</span><span class="token punctuation">,</span> <span class="token string">"7"</span><span class="token punctuation">,</span> <span class="token string">"8"</span><span class="token punctuation">,</span> <span class="token string">"9"</span><span class="token punctuation">,</span> <span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">,</span> <span class="token string">"E"</span><span class="token punctuation">,</span> <span class="token string">"F"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token keyword">public</span> base<span class="token punctuation">:</span> <span class="token keyword">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>base <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> base <span class="token operator">></span> ProgrammerCalculator<span class="token punctuation">.</span>digits<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"base has to be within 0 to 16 inclusive."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token function">processDigit</span><span class="token punctuation">(</span>digit<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">,</span> currentValue<span class="token punctuation">:</span> <span class="token keyword">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ProgrammerCalculator<span class="token punctuation">.</span>digits<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>digit<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> currentValue <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>base <span class="token operator">+</span> ProgrammerCalculator<span class="token punctuation">.</span>digits<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>digit<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">// Export the new extended calculator as Calculator</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> ProgrammerCalculator as Calculator <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// Also, export the helper function</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> test <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./Calculator"</span><span class="token punctuation">;</span>
</code></pre>
<p>The new module <code>ProgrammerCalculator</code> exports an API shape similar to that of the original <code>Calculator</code> module, but does not augment any objects in the original module.<br>Here is a test for our ProgrammerCalculator class:</p>
<h4 id="TestProgrammerCalculator-ts"><a href="#TestProgrammerCalculator-ts" class="headerlink" title="TestProgrammerCalculator.ts"></a>TestProgrammerCalculator.ts</h4><pre class=" language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> Calculator<span class="token punctuation">,</span> test <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./ProgrammerCalculator"</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Calculator</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">test</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token string">"001+010="</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// prints 3</span>
</code></pre>
<h2 id="Do-not-use-namespaces-in-modules"><a href="#Do-not-use-namespaces-in-modules" class="headerlink" title="Do not use namespaces in modules"></a>Do not use namespaces in modules</h2><p>When first moving to a module-based organization, a common tendency is to wrap exports in an additional layer of namespaces.<br>Modules have their own scope, and only exported declarations are visible from outside the module.<br>With this in mind, namespace provide very little, if any, value when working with modules.</p>
<p>On the organization front, namespaces are handy for grouping together logically-related objects and types in the global scope.<br>For example, in C#, you’re going to find all the collection types in System.Collections.<br>By organizing our types into hierarchical namespaces, we provide a good “discovery” experience for users of those types.<br>Modules, on the other hand, are already present in a file system, necessarily.<br>We have to resolve them by path and filename, so there’s a logical organization scheme for us to use.<br>We can have a /collections/generic/ folder with a list module in it.</p>
<p>Namespaces are important to avoid naming collisions in the global scope.<br>For example, you might have <code>My.Application.Customer.AddForm</code> and <code>My.Application.Order.AddForm</code> – two types with the same name, but a different namespace.<br>This, however, is not an issue with modules.<br>Within a module, there’s no plausible reason to have two objects with the same name.<br>From the consumption side, the consumer of any given module gets to pick the name that they will use to refer to the module, so accidental naming conflicts are impossible.</p>
<blockquote>
<p>For more discussion about modules and namespaces see <a href="./Namespaces and Modules.md">Namespaces and Modules</a>.</p>
</blockquote>
<h2 id="Red-Flags"><a href="#Red-Flags" class="headerlink" title="Red Flags"></a>Red Flags</h2><p>All of the following are red flags for module structuring. Double-check that you’re not trying to namespace your external modules if any of these apply to your files:</p>
<ul>
<li>A file whose only top-level declaration is <code>export namespace Foo { ... }</code> (remove <code>Foo</code> and move everything ‘up’ a level)</li>
<li>A file that has a single <code>export class</code> or <code>export function</code> (consider using <code>export default</code>)</li>
<li>Multiple files that have the same <code>export namespace Foo {</code> at top-level (don’t think that these are going to combine into one <code>Foo</code>!)</li>
</ul>

  </div>
</div>


<p class="nav-foot">
  <span class="left"><a href="/2018/05/25/online-ts-13/">« Iterators ...</a></span>
  <span class="right"><a href="/2018/05/25/online-ts-15/">Namespaces... »</a></span>
</p>

<!-- 文档信息 -->
<div class="post-foot">
  <h3>文档信息</h3>
  <ul>
    <li>版权声明：自由转载-非商用-非衍生-保持署名（
      <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh">创意共享3.0许可证</a>）
    </li>
    <li>作者：<a href="/">Lian</a></li>
    <li>日期：2018年05月25日 18:05</li>
    <li>邮箱：lian1925@126.com</li>
  </ul>
</div>
      




<div class="content-comment">
  <h2>留言</h2>
  
  
		
</div>

<!-- 评论输入组件，填写数据：留言，称呼，电子邮件 -->

<div class="form-comment">
  <h2>
		我要发表看法
	</h2>

	<form method="post" 
	target="targetIfr"
	action="">
	 <!-- 留言正文 -->
	 
		
<p>
	<label for="comment-content">
		您的留言:
	</label>
</p>

<p>
	<textarea 
	id="comment-content" 
	name="content" 
	rows="10" cols="50">
	</textarea>
</p>

		<!-- 姓名 -->
	 
		
<p>
	<label for="comment-author">
		您的大名:
	</label>
</p>

<p>
	<input 
	id="comment-author" 
	name="author" 
	size="30" 
	value=""
	pattern="^.{2,150}$"
	required
	>
	<span class="hint">
			 «-必填
	</span
</p>


		<!-- 微信 -->
	 
		
<p>
	<label for="comment-wechat">
		您的微信:
	</label>
</p>

<p>
	<input 
	id="comment-wechat" 
	name="wechat" 
	size="30" 
	value=""
	pattern="^[a-zA-Zd_]{5,}$"
	
	>
	<span class="hint">
			 «-选填，不公开
	</span
</p>


		<!-- 电子邮箱 -->
		
		
<p>
	<label for="comment-email">
		电子邮箱：
	</label>
</p>

<p>
	<input 
	id="comment-email" 
	name="email" 
	size="30" 
	value=""
	pattern="^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(.[a-zA-Z0-9_-]+)+$"
	
	>
	<span class="hint">
			 «-选填，不公开
	</span
</p>


		
		<p>

		
<div class="button">
    <input 
    class="submit-button" 
    onclick="doButton('addComment')"
    value="发表">
    <span class="hint"> «- 点击按钮</span>
</div>
		</p>
	</form>
	<iframe name="targetIfr" style="display:none"></iframe> 
</div>


<!-- data:{
	name:'',
	type:'passwor',
	label:'您的大名',
	hint:'',
	pattern:'[A-z]{3}',
	required:"required"
} -->


<p id="info-meta" style="display:none;">
  online-ts-14
</p>


<p id="info-url" style="display:none;">
  
</p>

<div class="footer">
  Copyright @ <a href="/">lian</a> | 2009-2018
</div>

</div>

<script src="/js/jquery.js"></script>
<script src="/js/APlayer.min.js"></script>
<script src="/js/post.js"></script>

</body>

</html>

