
<!DOCTYPE html>

<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="icon" type="image/png" href="/img/sand2.png">
  <link rel="shortcut icon" type="image/x-icon" href="/img/sand2.png">
  <meta property="og:image" content="https://assets-cdn.github.com/images/modules/open_graph/github-octocat.png">
  
  <link rel="stylesheet" href="/css/style.css?v=1.3"> 
  <link href="//vjs.zencdn.net/6.7/video-js.min.css" rel="stylesheet">
  <script src="//vjs.zencdn.net/6.7/video.min.js"></script>
  
  <title>Getting Started【启动】 With Contracts【合约】 | 教程 | 小沙丘的网络漫游记</title>
 <meta name="description" content="" >

 <!-- 百度统计 -->
 <script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?eafa0040e1ab3bed28ce82ef03de6e01";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
  </script>
  
<link rel="stylesheet" href="/css/prism-ghcolors.css" type="text/css"></head>
<body>
  
  <script>
      if (/mobile/i.test(navigator.userAgent) || /android/i.test(navigator.userAgent)){
        document.body.classList.add('mobile');            
      } else{
        document.body.classList.add('pc');
        document.getElementsByTagName("html")[0].style.fontSize="62.5%";
      }
      var u = navigator.userAgent;
var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Adr') > -1; //android终端
var isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端
if(isiOS){
  document.body.classList.add('ios');
  document.getElementsByTagName("html")[0].style.fontSize="65%";
           
}
    </script>

  <div class="container">
<!-- 用于文章页面的顶部，提供返回主页和主题页的按键 -->
<!-- 头部开始 -->

<div id="header">
    <p>小沙丘的网络漫游记
      <span> » 
        <a href="/home/">首页</a>
      </span>
      
      <span> » 
          <a href="/tags/EOS/">
            EOS
          </a>
      </span>
      
    </p>
</div>

<!-- 头部结束 -->



<!-- 分类组件，放置于文章页面的顶部，提供上(或下)一篇导航按键。 -->
<div class="asset-nav">
    <div class="entry-categories">
      <p>主题：
        <span> 
            <a href="/tags/EOS/">
              EOS
            </a>
        </span>
      </p>
    </div>
    <div class="entry-location-mobile">
        <span>
            
            <a href="/2018/05/21/online-eos-11/">
            &#8676;
            </a>
        </span>
        <span>
            
            <a href="/2018/05/21/online-eos-13/">
              &#8677;
            </a>
        </span>
    </div>
    <div class="entry-location">
        <P>上一篇：
                <a href="/2018/05/21/online-eos-11/">
                    Smart【智能】 Contract【合约】
                </a>
        </P>
        <P>下一篇：

                <a href="/2018/05/21/online-eos-13/">
                    eosio token Contract【合约】 | 教程
                </a>
        </P>
    </div>
</div>

<div class="post">
<div class="title-post">
<h1>Getting Started【启动】 With Contracts【合约】 | 教程</h1>
<div class="post-meta">
  <p>作者： Lian</p>
  <p>日期：
    2018年05月21日 20:05
  </p>
</div>
</div>



  
  <div class="page">
      <h2 id="Getting-Started-with-Contracts"><a href="#Getting-Started-with-Contracts" class="headerlink" title="Getting Started with Contracts"></a>Getting Started with Contracts</h2><p>The purpose of this tutorial is to demonstrate how to setup a local blockchain that can be used to experiment with smart contracts. The first part of this tutorial will focus on:</p>
<p>Starting a Private Blockchain</p>
<p>Creating a Wallet</p>
<p>Loading the Bios Contract</p>
<p>Creating Accounts</p>
<p>The second part of this tutorial will walk you through creating and deploying your own contracts.</p>
<p>eosio.token Contract</p>
<p>Exchange Contract</p>
<p>Hello World Contract</p>
<p>This tutorial assumes that you have installed EOSIO and that nodeos and cleos are in your path.</p>
<h2 id="Starting-a-Private-Blockchain"><a href="#Starting-a-Private-Blockchain" class="headerlink" title="Starting a Private Blockchain"></a>Starting a Private Blockchain</h2><p>You can start your own single-node blockchain with this single command:</p>
<pre class=" language-js"><code class="language-js">$ nodeos <span class="token operator">-</span>e <span class="token operator">-</span>p eosio <span class="token operator">--</span>plugin eosio<span class="token punctuation">:</span><span class="token punctuation">:</span>chain_api_plugin <span class="token operator">--</span>plugin eosio<span class="token punctuation">:</span><span class="token punctuation">:</span>history_api_plugin 
<span class="token operator">...</span>
eosio generated block 046b9984<span class="token operator">...</span> #<span class="token number">101527</span> @ <span class="token number">2018</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span>01T14<span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">:</span><span class="token number">58.000</span> <span class="token keyword">with</span> <span class="token number">0</span> trxs
eosio generated block 5e527ee2<span class="token operator">...</span> #<span class="token number">101528</span> @ <span class="token number">2018</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span>01T14<span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">:</span><span class="token number">58.500</span> <span class="token keyword">with</span> <span class="token number">0</span> trxs
</code></pre>
<p>This command sets many flags and loads some optional plugins which we will need for the rest of this tutorial. Assuming everything worked properly, you should see a block generation message every 0.5 seconds.</p>
<pre class=" language-js"><code class="language-js">eosio generated block 046b9984<span class="token operator">...</span> #<span class="token number">101527</span> @ <span class="token number">2018</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span>01T14<span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">:</span><span class="token number">58.000</span> <span class="token keyword">with</span> <span class="token number">0</span> trxs
</code></pre>
<p>This means your local blockchain is live, producing blocks, and ready to be used.</p>
<p>For more information about the arguments to nodeos you can use:</p>
<pre class=" language-js"><code class="language-js">nodeos <span class="token operator">--</span>help
</code></pre>
<h2 id="Creating-a-Wallet"><a href="#Creating-a-Wallet" class="headerlink" title="Creating a Wallet"></a>Creating a Wallet</h2><p>A wallet is a repository of private keys necessary to authorize actions on the blockchain. These keys are stored on disk encrypted using a password generated for you. This password should be stored in a secure password manager.</p>
<pre class=" language-js"><code class="language-js">$ cleos wallet create
Creating wallet<span class="token punctuation">:</span> <span class="token keyword">default</span>
Save password to use <span class="token keyword">in</span> the future to unlock <span class="token keyword">this</span> wallet<span class="token punctuation">.</span>
Without password imported keys will not be retrievable<span class="token punctuation">.</span>
<span class="token string">"PW5JuBXoXJ8JHiCTXfXcYuJabjF9f9UNNqHJjqDVY7igVffe3pXub"</span>
</code></pre>
<p>For the purpose of this simple development environment, your wallet is being managed by your local nodeos via the eosio::wallet_api_plugin we enabled when we started nodeos. Any time you restart nodeos you will have to unlock your wallet before you can use the keys within.</p>
<pre class=" language-js"><code class="language-js">$ cleos wallet unlock <span class="token operator">--</span>password PW5JuBXoXJ8JHiCTXfXcYuJabjF9f9UNNqHJjqDVY7igVffe3pXub
Unlocked<span class="token punctuation">:</span> <span class="token keyword">default</span>
</code></pre>
<p>It is generally not secure to use your password directly on the commandline where it gets logged to your bash history, so you can also unlock in interactive mode:</p>
<pre class=" language-js"><code class="language-js">$ cleos wallet unlock
password<span class="token punctuation">:</span>
</code></pre>
<p>For security purposes it is generally best to leave your wallet locked when you are not using it. To lock your wallet without shutting down nodeos you can do:</p>
<pre class=" language-js"><code class="language-js">$ cleos wallet lock
Locked<span class="token punctuation">:</span> <span class="token keyword">default</span>
</code></pre>
<p>You will need your wallet unlocked for the rest of this tutorial.</p>
<h2 id="Loading-the-Bios-Contract"><a href="#Loading-the-Bios-Contract" class="headerlink" title="Loading the Bios Contract"></a>Loading the Bios Contract</h2><p>Now that we have a wallet with the key for the eosio account loaded, we can set a default system contract. For the purposes of development, the default eosio.bios contract can be used. This contract enables you to have direct control over the resource allocation of other accounts and to access other privileged API calls. In a public blockchain, this contract will manage the staking and unstaking of tokens to reserve bandwidth for CPU and network activity, and memory for contracts.</p>
<p>The eosio.bios contract can be found in the contracts/eosio.bios folder of your EOSIO source code. The command sequence below assumes it is being executed from the root of the EOSIO source, but you can execute it from anywhere by specifying the full path to ${EOSIO_SOURCE}/build/contracts/eosio.bios.</p>
<pre class=" language-js"><code class="language-js">$ cleos <span class="token keyword">set</span> contract eosio build<span class="token operator">/</span>contracts<span class="token operator">/</span>eosio<span class="token punctuation">.</span>bios <span class="token operator">-</span>p eosio
Reading WAST<span class="token operator">...</span>
Assembling WASM<span class="token operator">...</span>
Publishing contract<span class="token operator">...</span>
executed transaction<span class="token punctuation">:</span> 414cf0dc7740d22474992779b2416b0eabdbc91522c16521307dd682051af083  <span class="token number">4068</span> bytes  <span class="token number">10000</span> cycles
#         eosio <span class="token operator">&lt;=</span> eosio<span class="token punctuation">:</span><span class="token punctuation">:</span>setcode               <span class="token punctuation">{</span><span class="token string">"account"</span><span class="token punctuation">:</span><span class="token string">"eosio"</span><span class="token punctuation">,</span><span class="token string">"vmtype"</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"vmversion"</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"code"</span><span class="token punctuation">:</span>"0061736d0100000001ab011960037f7e7f0060057f7e7e7e<span class="token operator">...</span>
#         eosio <span class="token operator">&lt;=</span> eosio<span class="token punctuation">:</span><span class="token punctuation">:</span>setabi                <span class="token punctuation">{</span><span class="token string">"account"</span><span class="token punctuation">:</span><span class="token string">"eosio"</span><span class="token punctuation">,</span><span class="token string">"abi"</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token string">"types"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"structs"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"set_account_limits"</span><span class="token punctuation">,</span><span class="token string">"base"</span><span class="token punctuation">:</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">"fields"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span>"n<span class="token operator">...</span>
</code></pre>
<p>The result of this command sequence is that cleos generated a transaction with two actions, eosio::setcode and eosio::setabi.</p>
<p>The code defines how the contract runs and the abi describes how to convert between binary and json representations of the arguments. While an abi is technically optional, all of the EOSIO tooling depends upon it for ease of use.</p>
<p>Any time you execute a transaction you will see output like:</p>
<pre class=" language-js"><code class="language-js">executed transaction<span class="token punctuation">:</span> 414cf0dc7740d22474992779b2416b0eabdbc91522c16521307dd682051af083  <span class="token number">4068</span> bytes  <span class="token number">10000</span> cycles
#         eosio <span class="token operator">&lt;=</span> eosio<span class="token punctuation">:</span><span class="token punctuation">:</span>setcode               <span class="token punctuation">{</span><span class="token string">"account"</span><span class="token punctuation">:</span><span class="token string">"eosio"</span><span class="token punctuation">,</span><span class="token string">"vmtype"</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"vmversion"</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"code"</span><span class="token punctuation">:</span>"0061736d0100000001ab011960037f7e7f0060057f7e7e7e<span class="token operator">...</span>
#         eosio <span class="token operator">&lt;=</span> eosio<span class="token punctuation">:</span><span class="token punctuation">:</span>setabi                <span class="token punctuation">{</span><span class="token string">"account"</span><span class="token punctuation">:</span><span class="token string">"eosio"</span><span class="token punctuation">,</span><span class="token string">"abi"</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token string">"types"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"structs"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"set_account_limits"</span><span class="token punctuation">,</span><span class="token string">"base"</span><span class="token punctuation">:</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">"fields"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span>"n<span class="token operator">...</span>
</code></pre>
<p>This can be read as: The action setcode as defined by eosio was executed by eosio contract with {args…}.</p>
<pre class=" language-js"><code class="language-js">#         $<span class="token punctuation">{</span>executor<span class="token punctuation">}</span> <span class="token operator">&lt;=</span> $<span class="token punctuation">{</span>contract<span class="token punctuation">}</span><span class="token punctuation">:</span>$<span class="token punctuation">{</span>action<span class="token punctuation">}</span> $<span class="token punctuation">{</span>args<span class="token operator">...</span><span class="token punctuation">}</span>
<span class="token operator">></span> console output <span class="token keyword">from</span> <span class="token keyword">this</span> execution<span class="token punctuation">,</span> <span class="token keyword">if</span> any
</code></pre>
<p>As we will see in a bit, actions can be processed by more than one contract.</p>
<p>The last argument to this call was -p eosio. This tells cleos to sign this action with the active authority of the eosio account, i.e., to sign the action using the private key for the eosio account that we imported earlier.</p>
<h2 id="Creating-Accounts"><a href="#Creating-Accounts" class="headerlink" title="Creating Accounts"></a>Creating Accounts</h2><p>Now that we have setup the basic system contract, we can start to create our own accounts. We will create two accounts, user and tester, and we will need to associate a key with each account. In this example, the same key will be used for both accounts.</p>
<p>To do this we first generate a key for the accounts.</p>
<pre class=" language-js"><code class="language-js">$ cleos create key
Private key<span class="token punctuation">:</span> 5Jmsawgsp1tQ3GD6JyGCwy1dcvqKZgX6ugMVMdjirx85iv5VyPR
Public key<span class="token punctuation">:</span> EOS7ijWCBmoXBi3CgtK7DJxentZZeTkeUnaSDvyro9dq7Sd1C3dC4
</code></pre>
<p>Then we import this key into our wallet:</p>
<pre class=" language-js"><code class="language-js">$ cleos wallet <span class="token keyword">import</span> 5Jmsawgsp1tQ3GD6JyGCwy1dcvqKZgX6ugMVMdjirx85iv5VyPR
imported <span class="token keyword">private</span> key <span class="token keyword">for</span><span class="token punctuation">:</span> EOS7ijWCBmoXBi3CgtK7DJxentZZeTkeUnaSDvyro9dq7Sd1C3dC4
</code></pre>
<p>NOTE: Be sure to use the actual key value generated by the cleos command and not the one shown in the example above!</p>
<p>Keys are not automatically added to a wallet, so skipping this step could result in losing control of your account.</p>
<h2 id="Create-Two-User-Accounts"><a href="#Create-Two-User-Accounts" class="headerlink" title="Create Two User Accounts"></a>Create Two User Accounts</h2><p>Next we will create two accounts, user and tester, using the key we created and imported above.</p>
<pre class=" language-js"><code class="language-js">$ cleos create account eosio user EOS7ijWCBmoXBi3CgtK7DJxentZZeTkeUnaSDvyro9dq7Sd1C3dC4 EOS7ijWCBmoXBi3CgtK7DJxentZZeTkeUnaSDvyro9dq7Sd1C3dC4
executed transaction<span class="token punctuation">:</span> 8aedb926cc1ca31642ada8daf4350833c95cbe98b869230f44da76d70f6d6242  <span class="token number">364</span> bytes  <span class="token number">1000</span> cycles
#         eosio <span class="token operator">&lt;=</span> eosio<span class="token punctuation">:</span><span class="token punctuation">:</span>newaccount            <span class="token punctuation">{</span><span class="token string">"creator"</span><span class="token punctuation">:</span><span class="token string">"eosio"</span><span class="token punctuation">,</span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"user"</span><span class="token punctuation">,</span><span class="token string">"owner"</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token string">"threshold"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"keys"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">"key"</span><span class="token punctuation">:</span>"EOS7ijWCBmoXBi3CgtK7DJxentZZ<span class="token operator">...</span>

$ cleos create account eosio tester EOS7ijWCBmoXBi3CgtK7DJxentZZeTkeUnaSDvyro9dq7Sd1C3dC4 EOS7ijWCBmoXBi3CgtK7DJxentZZeTkeUnaSDvyro9dq7Sd1C3dC4
executed transaction<span class="token punctuation">:</span> 414cf0dc7740d22474992779b2416b0eabdbc91522c16521307dd682051af083 <span class="token number">366</span> bytes  <span class="token number">1000</span> cycles
#         eosio <span class="token operator">&lt;=</span> eosio<span class="token punctuation">:</span><span class="token punctuation">:</span>newaccount            <span class="token punctuation">{</span><span class="token string">"creator"</span><span class="token punctuation">:</span><span class="token string">"eosio"</span><span class="token punctuation">,</span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"tester"</span><span class="token punctuation">,</span><span class="token string">"owner"</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token string">"threshold"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"keys"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">"key"</span><span class="token punctuation">:</span>"EOS7ijWCBmoXBi3CgtK7DJxentZZ<span class="token operator">...</span>
</code></pre>
<p>NOTE: The create account subcommand requires two keys, one for the OwnerKey (which in a production environment should be kept highly secure) and one for the ActiveKey. In this tutorial example, the same key is used for both.</p>
<p>Because we are using the eosio::history_api_plugin we can query all accounts that are controlled by our key:</p>
<pre class=" language-js"><code class="language-js">$ cleos <span class="token keyword">get</span> accounts EOS7ijWCBmoXBi3CgtK7DJxentZZeTkeUnaSDvyro9dq7Sd1C3dC4
<span class="token punctuation">{</span>
  <span class="token string">"account_names"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">"tester"</span><span class="token punctuation">,</span>
    <span class="token string">"user"</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="Next-Step-Eosio-token-Exchange-and-Eosio-msig-Contracts"><a href="#Next-Step-Eosio-token-Exchange-and-Eosio-msig-Contracts" class="headerlink" title="Next Step - Eosio.token, Exchange, and Eosio.msig Contracts"></a>Next Step - Eosio.token, Exchange, and Eosio.msig Contracts</h3><p>You are now ready to proceed to the next tutorial, Eosio.token, Exchange, and Eosio.msig Contracts</p>

  </div>
</div>


<p class="nav-foot">
  <span class="left"><a href="/2018/05/21/online-eos-11/">« Smart【智能】 ...</a></span>
  <span class="right"><a href="/2018/05/21/online-eos-13/">eosio toke... »</a></span>
</p>

<!-- 文档信息 -->
<div class="post-foot">
  <h3>文档信息</h3>
  <ul>
    <li>版权声明：自由转载-非商用-非衍生-保持署名（
      <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh">创意共享3.0许可证</a>）
    </li>
    <li>作者：<a href="/">Lian</a></li>
    <li>日期：2018年05月21日 20:05</li>
    <li>邮箱：lian1925@126.com</li>
  </ul>
</div>
      




<div class="content-comment">
  <h2>留言</h2>
  
  
		
</div>

<!-- 评论输入组件，填写数据：留言，称呼，电子邮件 -->

<div class="form-comment">
  <h2>
		我要发表看法
	</h2>

	<form method="post" 
	target="targetIfr"
	action="">
	 <!-- 留言正文 -->
	 
		
<p>
	<label for="comment-content">
		您的留言:
	</label>
</p>

<p>
	<textarea 
	id="comment-content" 
	name="content" 
	rows="10" cols="50">
	</textarea>
</p>

		<!-- 姓名 -->
	 
		
<p>
	<label for="comment-author">
		您的大名:
	</label>
</p>

<p>
	<input 
	id="comment-author" 
	name="author" 
	size="30" 
	value=""
	pattern="^.{2,150}$"
	required
	>
	<span class="hint">
			 «-必填
	</span
</p>


		<!-- 微信 -->
	 
		
<p>
	<label for="comment-wechat">
		您的微信:
	</label>
</p>

<p>
	<input 
	id="comment-wechat" 
	name="wechat" 
	size="30" 
	value=""
	pattern="^[a-zA-Zd_]{5,}$"
	
	>
	<span class="hint">
			 «-选填，不公开
	</span
</p>


		<!-- 电子邮箱 -->
		
		
<p>
	<label for="comment-email">
		电子邮箱：
	</label>
</p>

<p>
	<input 
	id="comment-email" 
	name="email" 
	size="30" 
	value=""
	pattern="^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(.[a-zA-Z0-9_-]+)+$"
	
	>
	<span class="hint">
			 «-选填，不公开
	</span
</p>


		
		<p>

		
<div class="button">
    <input 
    class="submit-button" 
    onclick="doButton('addComment')"
    value="发表">
    <span class="hint"> «- 点击按钮</span>
</div>
		</p>
	</form>
	<iframe name="targetIfr" style="display:none"></iframe> 
</div>


<!-- data:{
	name:'',
	type:'passwor',
	label:'您的大名',
	hint:'',
	pattern:'[A-z]{3}',
	required:"required"
} -->


<p id="info-meta" style="display:none;">
  online-eos-12
</p>


<p id="info-url" style="display:none;">
  
</p>

<div class="footer">
  Copyright @ <a href="/">lian</a> | 2009-2018
</div>

</div>

<script src="/js/jquery.js"></script>
<script src="/js/APlayer.min.js"></script>
<script src="/js/post.js"></script>

</body>

</html>

